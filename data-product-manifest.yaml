version: 0.0.2
jobId: "123"
jobName: Vendor Master
jobType: Source Aligned Data Product
domain: marketing
alias: load_in_iceberg
discoveryPort:
  name: Vendor Master
inputPorts:
  - alias: Vendor_Master_1
    isDynamic: true
    path: s3://byte-etl-externaldemo/shell-sample-data/Vendor_Master/part-00000-fb45ccc7-2e19-4081-919d-b22c2d7bd7c2-c000.snappy.parquet
    optional:
      persistDataFrame: false
      advanceOptions:
        mergeSchema: true
      enableDataReconciliation: false
      enforceSchema: false
      connection: Shell Demo S3 Connection
      dataSetUrn: urn:dv:dataset:a218a716-597a-4234-8d2f-6980e5eec258
    type: inputParquet
productState:
  isDynamic: true
  alias: load_in_iceberg
  retentionVersions: ""
  logicalSchema:
    properties:
      Vendor Name:
        type: STRING
        description: Name of the vendor.
        sourceColumn: Vendor Name
        sourceTable: vendor_master
      Vendor Contact Details:
        type: STRING
        description: Contact details of the vendor.
        sourceColumn: Vendor Contact Details
        sourceTable: vendor_master
      Vendor country Code:
        type: STRING
        description: Country code of the vendor's location.
        sourceColumn: Vendor country Code
        sourceTable: vendor_master
      Vendor Contact Number:
        type: STRING
        description: Contact number of the vendor.
        sourceColumn: Vendor Contact Number
        sourceTable: vendor_master
      Region Code:
        type: STRING
        description: Code representing the region where the vendor is located.
        sourceColumn: Region Code
        sourceTable: vendor_master
      Vendor ID:
        type: STRING
        description: Unique identifier for the vendor.
        sourceColumn: Vendor ID
        sourceTable: vendor_master
      Local Vendor Indication:
        type: STRING
        description: Indication of whether the vendor is a local vendor.
        sourceColumn: Local Vendor Indication
        sourceTable: vendor_master
      Vendor Type:
        type: STRING
        description: Type of the vendor.
        sourceColumn: Vendor Type
        sourceTable: vendor_master
      Payment Method:
        type: STRING
        description: Method of payment preferred by the vendor.
        sourceColumn: Payment Method
        sourceTable: vendor_master
      Client ID:
        type: STRING
        description: ID of the client associated with the vendor.
        sourceColumn: Client ID
        sourceTable: vendor_master
      Client Name:
        type: STRING
        description: Name of the client associated with the vendor.
        sourceColumn: Client Name
        sourceTable: vendor_master
      Vendor Country Name:
        type: STRING
        description: Name of the country where the vendor is located.
        sourceColumn: Vendor Country Name
        sourceTable: vendor_master
      Vendor Pin code:
        type: STRING
        description: Postal code of the vendor's location.
        sourceColumn: Vendor Pin code
        sourceTable: vendor_master
      Your Reference:
        type: STRING
        description: Reference provided by the vendor.
        sourceColumn: Your Reference
        sourceTable: vendor_master
      Customer Numbers:
        type: STRING
        description: Customer numbers associated with the vendor.
        sourceColumn: Customer Numbers
        sourceTable: vendor_master
      Material Number Used by Vendor:
        type: STRING
        description: Material number used by the vendor.
        sourceColumn: Material Number Used by Vendor
        sourceTable: vendor_master
      Status:
        type: STRING
        description: Status of the vendor.
        sourceColumn: Status
        sourceTable: vendor_master
      Purchase Info record number:
        type: STRING
        description: Number of the purchase info record associated with the vendor.
        sourceColumn: Purchase Info record number
        sourceTable: vendor_master
  stateStoreType: loadDataIceberg
  isProfilingEnabled: false
  updateStrategy: Overwrite
  tableName: s3source.vendor_master
  warehousePath: s3://bp-spark-sql-library-test-acc/
  catalogName: s3Source
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: false
    enforceSchemaMethod: Warning
    catalogType: glue
  refreshInterval: None
transformation:
  - isDynamic: true
    alias: Spark_SQL_1
    description: "Query for fetching data "
    sequence: 2
    inputDataFrameList:
      - inputDataFrame: Vendor_Master_1
        tempViewName: vendor_master
    query: select * from vendor_master
    optional:
      persistDataFrame: false
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules:
    NullValueCheck:
      productState:
        checks:
          - column: "`Vendor ID`"
        referenceAlias: load_in_iceberg
    UniquenessCheck:
      productState:
        checks:
          - column: "`Vendor ID`"
        referenceAlias: load_in_iceberg
