version: 0.0.2
jobId: "122"
jobName: Purchase Order
jobType: Source Aligned Data Product
domain: marketing
alias: load_in_iceberg
discoveryPort:
  name: Purchase Order
inputPorts:
  - alias: Purchase_Order_1
    isDynamic: true
    path: s3://byte-etl-externaldemo/shell-sample-data/Purchase_Order_output.csv
    optional:
      persistDataFrame: false
      advanceOptions:
        delimiter: ","
      enableDataReconciliation: false
      enforceSchema: false
      connection: Shell Demo S3 Connection
      dataSetUrn: urn:dv:dataset:1f646437-b498-47d8-88f0-3792a18329ce
    type: inputDelimited
productState:
  isDynamic: true
  alias: load_in_iceberg
  retentionVersions: ""
  logicalSchema:
    properties:
      Fixed Vendor:
        type: STRING
        description: Vendor that is predetermined or fixed for a specific purpose.
        sourceColumn: Fixed Vendor
        sourceTable: purchasing_order
      Document Status:
        type: STRING
        description: Current status of the document.
        sourceColumn: Document Status
        sourceTable: purchasing_order
      Account Assignment Category:
        type: STRING
        description: Category used for cost accounting and reporting purposes.
        sourceColumn: Account Assignment Category
        sourceTable: purchasing_order
      Purchasing Organization:
        type: STRING
        description: Organizational unit responsible for procurement.
        sourceColumn: Purchasing Organization
        sourceTable: purchasing_order
      Plant:
        type: STRING
        description: Physical location where materials are produced or stored.
        sourceColumn: Plant
        sourceTable: purchasing_order
      Item Number of the Purchasing Document:
        type: STRING
        description: Identifier for an item within a purchasing document.
        sourceColumn: Item Number of the Purchasing Document
        sourceTable: purchasing_order
      Delivery Date:
        type: STRING
        description: Date when the ordered goods are expected to be delivered.
        sourceColumn: Delivery Date
        sourceTable: purchasing_order
      Incoterms (Part 1):
        type: STRING
        description: International commercial terms defining the responsibilities of
          buyers and sellers.
        sourceColumn: Incoterms (Part 1)
        sourceTable: purchasing_order
      Material Number:
        type: STRING
        description: Unique identifier for a material.
        sourceColumn: Material Number
        sourceTable: purchasing_order
      Order Quantity:
        type: STRING
        description: Quantity of material ordered.
        sourceColumn: Order Quantity
        sourceTable: purchasing_order
      Order Unit:
        type: STRING
        description: Unit of measure for the quantity of material ordered.
        sourceColumn: Order Unit
        sourceTable: purchasing_order
      Net Price:
        type: STRING
        description: Price per unit of material, excluding taxes and discounts.
        sourceColumn: Net Price
        sourceTable: purchasing_order
      Net Order Value in Document Currency:
        type: STRING
        description: Total value of the order in document currency.
        sourceColumn: Net Order Value in Document Currency
        sourceTable: purchasing_order
      Material Group:
        type: STRING
        description: Grouping of materials with similar characteristics for procurement.
        sourceColumn: Material Group
        sourceTable: purchasing_order
      Vendor Number:
        type: STRING
        description: Unique identifier for the vendor supplying the material.
        sourceColumn: Vendor Number
        sourceTable: purchasing_order
      Cost Centre:
        type: STRING
        description: Cost center to which expenses related to the purchase are allocated.
        sourceColumn: Cost Centre
        sourceTable: purchasing_order
      Purchasing Document Number:
        type: STRING
        description: Identifier for the purchasing document.
        sourceColumn: Purchasing Document Number
        sourceTable: purchasing_order
      Status of Purchasing Document:
        type: STRING
        description: Current status of the purchasing document.
        sourceColumn: Status of Purchasing Document
        sourceTable: purchasing_order
      Date on Which Record Was Created:
        type: STRING
        description: Date when the record was created.
        sourceColumn: Date on Which Record Was Created
        sourceTable: purchasing_order
      Cash (Prompt Payment) Discount Days:
        type: STRING
        description: Number of days within which a prompt payment discount can be availed.
        sourceColumn: Cash (Prompt Payment) Discount Days
        sourceTable: purchasing_order
      Exchange Rate:
        type: STRING
        description: Rate at which one currency can be exchanged for another.
        sourceColumn: Exchange Rate
        sourceTable: purchasing_order
      Number of Principal Purchase Agreement:
        type: STRING
        description: Identifier for the principal purchase agreement associated with the
          purchasing document.
        sourceColumn: Number of Principal Purchase Agreement
        sourceTable: purchasing_order
      Creator Id:
        type: STRING
        description: Identifier of the user who created the record.
        sourceColumn: Creator Id
        sourceTable: purchasing_order
      Approval ID:
        type: STRING
        description: Identifier of the approval process associated with the purchasing
          document.
        sourceColumn: Approval ID
        sourceTable: purchasing_order
      Department:
        type: STRING
        description: Department responsible for the purchasing process.
        sourceColumn: Department
        sourceTable: purchasing_order
      Release status:
        type: STRING
        description: Status indicating whether the purchasing document has been released
          for further processing.
        sourceColumn: Release status
        sourceTable: purchasing_order
      SUPPLIER:
        type: STRING
        description: Name of the supplier providing the goods or services.
        sourceColumn: SUPPLIER
        sourceTable: purchasing_order
      PO Quantity Sender:
        type: STRING
        description: Identifier of the sender of the purchase order quantity.
        sourceColumn: PO Quantity Sender
        sourceTable: purchasing_order
  stateStoreType: loadDataIceberg
  isProfilingEnabled: false
  updateStrategy: Overwrite
  tableName: s3source.purchase_order
  warehousePath: s3://bp-spark-sql-library-test-acc/
  catalogName: s3Source
  optional:
    persistDataFrame: false
    enableDataReconciliation: false
    enforceSchema: false
    enforceSchemaMethod: Warning
    catalogType: glue
  refreshInterval: None
transformation:
  - isDynamic: true
    alias: Spark_SQL_1
    description: "Query for fetching data "
    sequence: 2
    inputDataFrameList:
      - inputDataFrame: Purchase_Order_1
        tempViewName: purchase_order
    query: select * from purchase_order
    optional:
      persistDataFrame: false
    type: operationThroughSqlQuery
controlPort:
  dataQualityRules:
    NullValueCheck:
      productState:
        checks:
          - column: "`Purchasing Document Number`"
        referenceAlias: load_in_iceberg
